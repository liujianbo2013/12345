<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¦»çº¿å¯ç”¨çš„ PWA ç¤ºä¾‹</title>
    <!-- å¼•å…¥ manifest é…ç½® -->
    <link rel="manifest" href="/manifest.json">
    <!-- ç®€å•æ ·å¼ï¼Œè®©é¡µé¢æ›´æ˜“è¯» -->
    <style>
        body {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        .offline-tip {
            color: #e74c3c;
            font-weight: bold;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <h1>âœ… PWA ç¦»çº¿è®¿é—®ç¤ºä¾‹</h1>
    <p>æ­¥éª¤ï¼š</p>
    <ol>
        <li>è”ç½‘çŠ¶æ€ä¸‹åˆ·æ–°æœ¬é¡µé¢ï¼ˆè§¦å‘ç¼“å­˜ï¼‰</li>
        <li>å…³é—­ç½‘ç»œï¼ˆæ–­å¼€ WiFi/æµé‡ï¼‰</li>
        <li>å†æ¬¡åˆ·æ–°é¡µé¢ï¼Œä»ç„¶èƒ½æ­£å¸¸æ˜¾ç¤º</li>
    </ol>
    <div class="offline-tip" id="status"></div>

    <script>
        // 1. æ£€æµ‹ç½‘ç»œçŠ¶æ€å¹¶æç¤º
        const statusEl = document.getElementById('status');
        function updateNetworkStatus() {
            if (!navigator.onLine) {
                statusEl.textContent = "âš ï¸ å½“å‰å¤„äºç¦»çº¿çŠ¶æ€ï¼Œä½†é¡µé¢ä»èƒ½æ˜¾ç¤ºï¼ˆæ¥è‡ªæœ¬åœ°ç¼“å­˜ï¼‰ï¼";
            } else {
                statusEl.textContent = "âœ… å½“å‰å¤„äºåœ¨çº¿çŠ¶æ€ï¼Œå·²ç¼“å­˜èµ„æºä¾›ç¦»çº¿ä½¿ç”¨ã€‚";
            }
        }
        // ç›‘å¬ç½‘ç»œçŠ¶æ€å˜åŒ–
        window.addEventListener('online', updateNetworkStatus);
        window.addEventListener('offline', updateNetworkStatus);
        // åˆå§‹åŒ–çŠ¶æ€
        updateNetworkStatus();

        // 2. æ³¨å†Œ Service Workerï¼ˆæ ¸å¿ƒï¼šå®ç°ç¦»çº¿ç¼“å­˜ï¼‰
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    // æ³¨å†Œ service-worker.js
                    const registration = await navigator.serviceWorker.register('/service-worker.js');
                    console.log('Service Worker æ³¨å†ŒæˆåŠŸ ğŸ‰', registration.scope);
                } catch (error) {
                    console.error('Service Worker æ³¨å†Œå¤±è´¥ âŒ', error);
                }
            });
        }
    </script>
</body>
</html>
